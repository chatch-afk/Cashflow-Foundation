<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cash Flow Foundation</title>

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React 18 (UMD) -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

    <!-- Babel (enables JSX without build tooling) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>

  <body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
      // Cash Flow Foundation — Client Dashboard (GitHub Pages Single-File)
      // Notes:
      // - “Paid” items retain funded history but are excluded from active FO reserved math.
      // - Plain JSX + React UMD + Babel (no build step).

      function makeId() {
        if (
          typeof crypto !== "undefined" &&
          crypto &&
          typeof crypto.randomUUID === "function"
        ) {
          return crypto.randomUUID();
        }
        return `id_${Math.random().toString(16).slice(2)}_${Date.now()}`;
      }

      function toNumber(maybe) {
        const n = Number(String(maybe || "").replace(/,/g, ""));
        return Number.isFinite(n) ? n : 0;
      }

      function fmtUSD(n) {
        return Number(n || 0).toLocaleString(undefined, {
          style: "currency",
          currency: "USD",
          maximumFractionDigits: 0,
        });
      }

      function MoneyInput({ value, onChange, placeholder = "0" }) {
        return (
          <div className="flex items-center gap-2">
            <span className="text-slate-500">$</span>
            <input
              inputMode="decimal"
              placeholder={placeholder}
              value={value}
              onChange={(e) => {
                const next = e.target.value.replace(/[^0-9.,]/g, "");
                onChange(next);
              }}
              className="border rounded-xl px-3 py-2 w-full bg-white"
            />
          </div>
        );
      }

      function PercentInput({ value, onChange, placeholder = "10" }) {
        return (
          <div className="flex items-center gap-2">
            <input
              inputMode="decimal"
              placeholder={placeholder}
              value={value}
              onChange={(e) => {
                const v = e.target.value.replace(/[^0-9.]/g, "");
                const n = Math.min(100, Math.max(0, Number(v || 0)));
                onChange(String(Number.isFinite(n) ? n : 0));
              }}
              className="border rounded-xl px-3 py-2 w-full bg-white"
            />
            <span className="text-slate-500">%</span>
          </div>
        );
      }

      function Toggle({ checked, onChange }) {
        return (
          <button
            type="button"
            onClick={() => onChange(!checked)}
            className={
              "relative inline-flex h-6 w-11 items-center rounded-full border transition " +
              (checked
                ? "bg-slate-900 border-slate-900"
                : "bg-slate-200 border-slate-200")
            }
            aria-pressed={checked}
          >
            <span
              className={
                "inline-block h-4 w-4 transform rounded-full bg-white transition " +
                (checked ? "translate-x-6" : "translate-x-1")
              }
            />
          </button>
        );
      }

      function monthOptions(startYear = 2026) {
        const out = [];
        for (let m = 1; m <= 12; m++) {
          out.push(`${startYear}-${String(m).padStart(2, "0")}`);
        }
        return out;
      }

      function monthAdd(yyyymm, add) {
        const [y, m] = String(yyyymm).split("-").map((x) => Number(x));
        const d = new Date(y, (m || 1) - 1, 1);
        d.setMonth(d.getMonth() + add);
        return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, "0")}`;
      }

      function monthDiff(a, b) {
        const [ay, am] = String(a).split("-").map(Number);
        const [by, bm] = String(b).split("-").map(Number);
        return (by - ay) * 12 + (bm - am);
      }

      // -------------------------
      // Lightweight self-tests
      // -------------------------
      function runSelfTests() {
        console.assert(toNumber("1,234") === 1234, "toNumber parses comma numbers");
        console.assert(toNumber("abc") === 0, "toNumber returns 0 on invalid");
        console.assert(monthAdd("2026-01", 1) === "2026-02", "monthAdd works");
        console.assert(monthDiff("2026-01", "2026-06") === 5, "monthDiff works");
        console.assert(typeof fmtUSD(1000) === "string", "fmtUSD formats");
      }

      try {
        // In the browser, process might be undefined; safe-guarded.
        const __DEV__ =
          typeof process !== "undefined" &&
          process &&
          process.env &&
          process.env.NODE_ENV !== "production";
        if (__DEV__) runSelfTests();
      } catch {
        // If no process env, still okay to run tests in console:
        try { runSelfTests(); } catch {}
      }

      function StatCard({ label, value, hint, emphasis = "default" }) {
        const valueClass =
          emphasis === "good"
            ? "text-emerald-700"
            : emphasis === "bad"
            ? "text-red-700"
            : "text-slate-900";

        return (
          <div className="rounded-2xl border bg-white p-4">
            <div className="text-xs font-semibold text-slate-500">{label}</div>
            <div className={`mt-2 text-xl font-semibold ${valueClass}`}>{value}</div>
            {hint ? <div className="mt-1 text-xs text-slate-500">{hint}</div> : null}
          </div>
        );
      }

      function App() {
        // Month context
        const [currentMonth, setCurrentMonth] = React.useState("2026-01");

        // Cash In
        const [businessIn, setBusinessIn] = React.useState("90000");
        const [w2In, setW2In] = React.useState("10000");

        // Accounts (setup data)
        const [accounts, setAccounts] = React.useState({
          familyOffice: { label: "Family Office", institution: "BoA", last4: "3446" },
          giving: { label: "Giving", institution: "BoA", last4: "1289" },
          lifestyle: { label: "Lifestyle", institution: "Chase", last4: "7721" },
          wealth: { label: "Wealth Creation", institution: "Fidelity", last4: "" },
        });

        // Rules
        const [givingIsDollar, setGivingIsDollar] = React.useState(false);
        const [givingPercent, setGivingPercent] = React.useState("10");
        const [givingDollar, setGivingDollar] = React.useState("1000");
        const [lifestyleMonthly, setLifestyleMonthly] = React.useState("20000");

        // Needs ledger
        const [needs, setNeeds] = React.useState([
          { id: "1", name: "Taxes", target: "12000", dueMonth: "2026-04", funded: "0", status: "open" },
          { id: "2", name: "Trip", target: "8000", dueMonth: "2026-06", funded: "0", status: "open" },
        ]);

        const [showPaid, setShowPaid] = React.useState(false);
        const [showAccounts, setShowAccounts] = React.useState(false);

        // Derived values
        const inflow = toNumber(businessIn) + toNumber(w2In);

        const givingAmount = givingIsDollar
          ? Math.min(toNumber(givingDollar), inflow)
          : (toNumber(givingPercent) / 100) * inflow;

        const emergencyHeldInFO = 1 * toNumber(lifestyleMonthly);
        const lifestyleTargetBalance = 2 * toNumber(lifestyleMonthly);

        const activeNeeds = needs.filter((n) => n.status === "open");
        const paidNeeds = needs.filter((n) => n.status === "paid");

        // Only OPEN funded amounts count toward Family Office reserved balance
        const totalReservedOpen = activeNeeds.reduce((sum, n) => sum + toNumber(n.funded), 0);
        const totalPaidHistorical = paidNeeds.reduce((sum, n) => sum + toNumber(n.funded), 0);

        const inWindow = (n) => {
          if (!n || n.status !== "open") return false;
          const diff = monthDiff(currentMonth, n.dueMonth);
          return diff >= 0 && diff <= 5;
        };

        const windowNeeds = needs.filter(inWindow);

        const remainingTotal = windowNeeds.reduce((sum, n) => {
          const remaining = Math.max(0, toNumber(n.target) - toNumber(n.funded));
          return sum + remaining;
        }, 0);

        const availableAfterRequired = inflow - givingAmount - toNumber(lifestyleMonthly);
        const allocateToNeeds = Math.max(0, Math.min(availableAfterRequired, remainingTotal));
        const excess = availableAfterRequired - allocateToNeeds;

        // Actions
        function updateAccount(key, patch) {
          setAccounts((prev) => ({ ...prev, [key]: { ...prev[key], ...patch } }));
        }

        function addNeed() {
          setNeeds((prev) => [
            ...prev,
            {
              id: makeId(),
              name: "",
              target: "0",
              dueMonth: monthAdd(currentMonth, 1),
              funded: "0",
              status: "open",
            },
          ]);
        }

        function updateNeed(id, patch) {
          setNeeds((prev) => prev.map((n) => (n.id === id ? { ...n, ...patch } : n)));
        }

        function removeNeed(id) {
          setNeeds((prev) => prev.filter((n) => n.id !== id));
        }

        function markPaid(id) {
          setNeeds((prev) =>
            prev.map((n) => (n.id === id ? { ...n, status: "paid", paidMonth: currentMonth } : n))
          );
        }

        function reopenNeed(id) {
          setNeeds((prev) => prev.map((n) => (n.id === id ? { ...n, status: "open", paidMonth: undefined } : n)));
        }

        function runMonthlyAllocation() {
          const sorted = [...needs].sort((a, b) => monthDiff(a.dueMonth, b.dueMonth));
          let remainingPool = allocateToNeeds;

          const next = sorted.map((n) => {
            if (!inWindow(n)) return n;
            if (remainingPool <= 0) return n;

            const remaining = Math.max(0, toNumber(n.target) - toNumber(n.funded));
            const add = Math.min(remaining, remainingPool);
            remainingPool -= add;

            return { ...n, funded: String(toNumber(n.funded) + add) };
          });

          const byId = new Map(next.map((n) => [n.id, n]));
          setNeeds((prev) => prev.map((n) => byId.get(n.id) ?? n));
        }

        function rolloverToNextMonth() {
          setCurrentMonth((m) => monthAdd(m, 1));
        }

        const months = monthOptions(2026);

        return (
          <div className="min-h-screen bg-slate-50 p-4 md:p-6">
            <div className="max-w-7xl mx-auto space-y-4">
              {/* Reality Bar */}
              <div className="rounded-2xl border bg-white p-4">
                <div className="flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between">
                  <div>
                    <div className="text-xl font-semibold">Cash Flow Foundation</div>
                    <div className="text-sm text-slate-600">Monthly cash allocation dashboard</div>
                  </div>

                  <div className="flex items-center gap-2">
                    <div className="text-xs font-semibold text-slate-500">Month</div>
                    <select
                      value={currentMonth}
                      onChange={(e) => setCurrentMonth(e.target.value)}
                      className="border rounded-xl px-3 py-2 text-sm bg-white"
                    >
                      {months.map((m) => (
                        <option key={m} value={m}>
                          {m}
                        </option>
                      ))}
                    </select>
                    <button
                      type="button"
                      onClick={rolloverToNextMonth}
                      className="text-sm font-semibold rounded-xl border px-3 py-2 hover:bg-slate-50"
                    >
                      Next month →
                    </button>
                    <button
                      type="button"
                      onClick={() => setShowAccounts((v) => !v)}
                      className="text-sm font-semibold rounded-xl border px-3 py-2 hover:bg-slate-50"
                    >
                      {showAccounts ? "Hide" : "Show"} accounts
                    </button>
                  </div>

                  <div className="flex items-stretch gap-3">
                    <div className="rounded-xl border bg-slate-50 px-4 py-3">
                      <div className="text-xs font-semibold text-slate-500">Inflow</div>
                      <div className="mt-1 font-semibold">{fmtUSD(inflow)}</div>
                    </div>
                    <div className="rounded-xl border bg-slate-50 px-4 py-3">
                      <div className="text-xs font-semibold text-slate-500">Excess</div>
                      <div className={"mt-1 font-semibold " + (excess >= 0 ? "text-emerald-700" : "text-red-700")}>
                        {fmtUSD(excess)}
                      </div>
                    </div>
                  </div>
                </div>

                {showAccounts ? (
                  <div className="mt-4 rounded-2xl border bg-white p-4">
                    <div className="flex items-center justify-between">
                      <div>
                        <div className="text-sm font-semibold">Linked Accounts</div>
                        <div className="text-xs text-slate-500">Setup once … used for transfer instructions</div>
                      </div>
                    </div>
                    <div className="mt-3 grid gap-3 md:grid-cols-2">
                      {Object.keys(accounts).map((k) => (
                        <div key={k} className="rounded-xl border bg-slate-50 p-3">
                          <div className="flex items-center justify-between">
                            <div className="text-sm font-semibold">{accounts[k].label}</div>
                            <div className="text-xs text-slate-500">Required</div>
                          </div>
                          <div className="mt-2 grid grid-cols-3 gap-2">
                            <input
                              value={accounts[k].institution}
                              onChange={(e) => updateAccount(k, { institution: e.target.value })}
                              placeholder="Bank"
                              className="border rounded-xl px-3 py-2 text-sm col-span-2 bg-white"
                            />
                            <input
                              value={accounts[k].last4}
                              onChange={(e) =>
                                updateAccount(k, {
                                  last4: e.target.value.replace(/[^0-9]/g, "").slice(0, 4),
                                })
                              }
                              placeholder="Last 4"
                              className="border rounded-xl px-3 py-2 text-sm bg-white"
                            />
                          </div>
                        </div>
                      ))}
                    </div>
                    <div className="mt-2 text-xs text-slate-500">Family Office is savings-only (no debit) … transfers only.</div>
                  </div>
                ) : null}
              </div>

              {/* HERO */}
              <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
                <StatCard label="Emergency minimum" value={fmtUSD(emergencyHeldInFO)} hint="Required balance in Family Office" />
                <StatCard label="Reserved for open needs" value={fmtUSD(totalReservedOpen)} hint="Counts toward Family Office reserve" />
                <StatCard label="Remaining needs (next 6 months)" value={fmtUSD(remainingTotal)} hint="Gap still to fund" />
                <StatCard
                  label="Excess after rules"
                  value={fmtUSD(excess)}
                  hint="Available for wealth creation"
                  emphasis={excess >= 0 ? "good" : "bad"}
                />
              </div>

              {/* Decision layer */}
              <div className="grid gap-4 lg:grid-cols-3">
                <div className="rounded-2xl border bg-white p-5">
                  <div className="text-sm font-semibold">Cash In</div>
                  <div className="mt-3 grid gap-3 md:grid-cols-2">
                    <div>
                      <div className="text-xs font-semibold text-slate-500">Business</div>
                      <div className="mt-2">
                        <MoneyInput value={businessIn} onChange={setBusinessIn} />
                      </div>
                    </div>
                    <div>
                      <div className="text-xs font-semibold text-slate-500">W-2 / Other</div>
                      <div className="mt-2">
                        <MoneyInput value={w2In} onChange={setW2In} />
                      </div>
                    </div>
                  </div>
                  <div className="mt-3 rounded-xl border bg-slate-50 p-3">
                    <div className="text-xs font-semibold text-slate-500">Total inflow</div>
                    <div className="mt-1 text-lg font-semibold">{fmtUSD(inflow)}</div>
                    <div className="mt-1 text-xs text-slate-500">All cash lands in Family Office first</div>
                  </div>
                </div>

                <div className="rounded-2xl border bg-white p-5">
                  <div className="flex items-center justify-between">
                    <div>
                      <div className="text-sm font-semibold">Giving rule</div>
                      <div className="text-xs text-slate-500">Percentage of inflow … or fixed monthly amount</div>
                    </div>
                    <div className="flex items-center gap-2">
                      <span className={"text-xs " + (!givingIsDollar ? "font-semibold text-slate-900" : "text-slate-500")}>%</span>
                      <Toggle checked={givingIsDollar} onChange={setGivingIsDollar} />
                      <span className={"text-xs " + (givingIsDollar ? "font-semibold text-slate-900" : "text-slate-500")}>$</span>
                    </div>
                  </div>

                  <div className="mt-3">
                    {!givingIsDollar ? (
                      <PercentInput value={givingPercent} onChange={setGivingPercent} />
                    ) : (
                      <MoneyInput value={givingDollar} onChange={setGivingDollar} placeholder="1000" />
                    )}
                  </div>

                  <div className="mt-3 rounded-xl border bg-slate-50 p-3">
                    <div className="text-xs font-semibold text-slate-500">This month … giving transfer</div>
                    <div className="mt-1 text-lg font-semibold">{fmtUSD(Math.max(0, givingAmount))}</div>
                  </div>
                </div>

                <div className="rounded-2xl border bg-white p-5">
                  <div className="text-sm font-semibold">Lifestyle rule</div>
                  <div className="text-xs text-slate-500 mt-1">Monthly transfer to Lifestyle checking</div>
                  <div className="mt-3">
                    <MoneyInput value={lifestyleMonthly} onChange={setLifestyleMonthly} placeholder="20000" />
                  </div>
                  <div className="mt-2 text-xs text-slate-500">Target Lifestyle balance (2× spend): {fmtUSD(lifestyleTargetBalance)}</div>
                </div>
              </div>

              {/* Execution: needs */}
              <div className="rounded-2xl border bg-white p-5">
                <div className="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
                  <div>
                    <div className="text-lg font-semibold">Upcoming Cash Needs (Next 6 Months)</div>
                    <div className="text-xs text-slate-500 mt-1">Funded balances carry forward … mark Paid to archive and stop rolling.</div>
                  </div>
                  <div className="flex items-center gap-2">
                    <button type="button" onClick={addNeed} className="text-sm font-semibold rounded-xl border px-3 py-2 hover:bg-slate-50">
                      + Add item
                    </button>
                    <button
                      type="button"
                      onClick={runMonthlyAllocation}
                      className="text-sm font-semibold rounded-xl px-3 py-2 bg-slate-900 text-white hover:bg-slate-800"
                    >
                      Fund needs this month
                    </button>
                  </div>
                </div>

                <div className="mt-4 overflow-x-auto">
                  <table className="w-full text-sm border-collapse">
                    <thead>
                      <tr className="text-left text-slate-500">
                        <th className="pb-2">Need</th>
                        <th className="pb-2">Due</th>
                        <th className="pb-2">Target</th>
                        <th className="pb-2">Already funded</th>
                        <th className="pb-2">Remaining</th>
                        <th className="pb-2">Paid</th>
                        <th className="pb-2" />
                      </tr>
                    </thead>
                    <tbody className="text-slate-800">
                      {activeNeeds.map((n) => {
                        const remaining = Math.max(0, toNumber(n.target) - toNumber(n.funded));
                        const isInWindow = inWindow(n);
                        return (
                          <tr key={n.id} className={"border-t " + (isInWindow ? "" : "opacity-50")}>
                            <td className="py-2 pr-2">
                              <input
                                value={n.name}
                                onChange={(e) => updateNeed(n.id, { name: e.target.value })}
                                placeholder="e.g. Taxes, Vehicle, Tuition"
                                className="border rounded-xl px-3 py-2 w-full bg-white"
                              />
                            </td>
                            <td className="py-2 pr-2">
                              <select
                                value={n.dueMonth}
                                onChange={(e) => updateNeed(n.id, { dueMonth: e.target.value })}
                                className="border rounded-xl px-3 py-2 bg-white"
                              >
                                {months.map((m) => (
                                  <option key={m} value={m}>
                                    {m}
                                  </option>
                                ))}
                              </select>
                            </td>
                            <td className="py-2 pr-2 w-[170px]">
                              <MoneyInput value={n.target} onChange={(v) => updateNeed(n.id, { target: v })} />
                            </td>
                            <td className="py-2 pr-2 w-[170px]">
                              <MoneyInput value={n.funded} onChange={(v) => updateNeed(n.id, { funded: v })} />
                            </td>
                            <td className="py-2 pr-2 font-semibold">{fmtUSD(remaining)}</td>
                            <td className="py-2 pr-2">
                              <button
                                type="button"
                                onClick={() => markPaid(n.id)}
                                className="text-sm font-semibold rounded-xl border px-3 py-2 hover:bg-slate-50"
                              >
                                Mark paid
                              </button>
                            </td>
                            <td className="py-2 text-right">
                              <button
                                type="button"
                                onClick={() => removeNeed(n.id)}
                                className="text-slate-500 hover:text-slate-900"
                                title="Remove"
                              >
                                ×
                              </button>
                            </td>
                          </tr>
                        );
                      })}

                      {activeNeeds.length === 0 ? (
                        <tr className="border-t">
                          <td className="py-6 text-sm text-slate-500" colSpan={7}>
                            No active needs. Add an item if you expect a &gt;$5k cash need in the next six months.
                          </td>
                        </tr>
                      ) : null}
                    </tbody>
                  </table>
                </div>

                <div className="mt-4 grid gap-3 md:grid-cols-3">
                  <div className="rounded-xl border bg-slate-50 p-3">
                    <div className="text-xs font-semibold text-slate-500">This month … suggested funding</div>
                    <div className="mt-1 text-lg font-semibold">{fmtUSD(allocateToNeeds)}</div>
                  </div>
                  <div className="rounded-xl border bg-slate-50 p-3">
                    <div className="text-xs font-semibold text-slate-500">Available after giving + lifestyle</div>
                    <div className="mt-1 text-lg font-semibold">{fmtUSD(availableAfterRequired)}</div>
                  </div>
                  <div className="rounded-xl border bg-slate-50 p-3">
                    <div className="text-xs font-semibold text-slate-500">Paid (historical only)</div>
                    <div className="mt-1 text-lg font-semibold">{fmtUSD(totalPaidHistorical)}</div>
                  </div>
                </div>

                <div className="mt-5 rounded-2xl border bg-white">
                  <div className="p-4 flex items-center justify-between">
                    <div>
                      <div className="font-semibold">Paid (Archived)</div>
                      <div className="text-xs text-slate-500">Kept for history … excluded from Family Office reserve math</div>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="text-xs text-slate-500">{paidNeeds.length} total</div>
                      <Toggle checked={showPaid} onChange={setShowPaid} />
                    </div>
                  </div>

                  {showPaid ? (
                    <div className="px-4 pb-4 overflow-x-auto">
                      <table className="w-full text-sm border-collapse">
                        <thead>
                          <tr className="text-left text-slate-500">
                            <th className="pb-2">Need</th>
                            <th className="pb-2">Due</th>
                            <th className="pb-2">Target</th>
                            <th className="pb-2">Funded at time of pay</th>
                            <th className="pb-2">Paid month</th>
                            <th className="pb-2" />
                          </tr>
                        </thead>
                        <tbody className="text-slate-800">
                          {paidNeeds.map((n) => (
                            <tr key={n.id} className="border-t">
                              <td className="py-2">{n.name || "—"}</td>
                              <td className="py-2">{n.dueMonth}</td>
                              <td className="py-2">{fmtUSD(toNumber(n.target))}</td>
                              <td className="py-2">{fmtUSD(toNumber(n.funded))}</td>
                              <td className="py-2">{n.paidMonth || "—"}</td>
                              <td className="py-2 text-right">
                                <button
                                  type="button"
                                  onClick={() => reopenNeed(n.id)}
                                  className="text-sm font-semibold rounded-xl border px-3 py-2 hover:bg-slate-50"
                                >
                                  Reopen
                                </button>
                              </td>
                            </tr>
                          ))}
                          {paidNeeds.length === 0 ? (
                            <tr className="border-t">
                              <td className="py-6 text-sm text-slate-500" colSpan={6}>
                                No paid items yet.
                              </td>
                            </tr>
                          ) : null}
                        </tbody>
                      </table>
                    </div>
                  ) : null}
                </div>
              </div>

              {/* Execution: transaction report */}
              <div className="rounded-2xl border bg-white p-6">
                <div className="flex flex-col gap-2 md:flex-row md:items-center md:justify-between">
                  <div>
                    <div className="text-lg font-semibold">Monthly Transfer Instructions</div>
                    <div className="text-xs text-slate-500 mt-1">Run monthly … keep screenshots as proof of completion</div>
                  </div>
                  <div className="text-xs text-slate-500">
                    From: Family Office ({accounts.familyOffice.institution || "—"} •••• {accounts.familyOffice.last4 || "—"})
                  </div>
                </div>

                <div className="mt-4 overflow-x-auto">
                  <table className="w-full text-sm border-collapse">
                    <thead>
                      <tr className="text-left text-slate-500">
                        <th className="pb-2">From</th>
                        <th className="pb-2">To</th>
                        <th className="pb-2">Amount</th>
                        <th className="pb-2">Purpose</th>
                      </tr>
                    </thead>
                    <tbody className="text-slate-800">
                      <tr className="border-t">
                        <td className="py-2">Family Office</td>
                        <td className="py-2">Giving ({accounts.giving.institution || "—"} •••• {accounts.giving.last4 || "—"})</td>
                        <td className="py-2">{fmtUSD(Math.max(0, givingAmount))}</td>
                        <td className="py-2">Charitable giving</td>
                      </tr>
                      <tr className="border-t">
                        <td className="py-2">Family Office</td>
                        <td className="py-2">Lifestyle ({accounts.lifestyle.institution || "—"} •••• {accounts.lifestyle.last4 || "—"})</td>
                        <td className="py-2">{fmtUSD(toNumber(lifestyleMonthly))}</td>
                        <td className="py-2">Monthly lifestyle funding</td>
                      </tr>
                      <tr className="border-t">
                        <td className="py-2">Family Office</td>
                        <td className="py-2">(Internal) Needs reserve</td>
                        <td className="py-2">{fmtUSD(allocateToNeeds)}</td>
                        <td className="py-2">Earmark for upcoming needs (stays in Family Office)</td>
                      </tr>
                      <tr className="border-t font-semibold">
                        <td className="py-2">Family Office</td>
                        <td className="py-2">
                          Wealth Creation ({accounts.wealth.institution || "—"}
                          {accounts.wealth.last4 ? ` •••• ${accounts.wealth.last4}` : ""})
                        </td>
                        <td className={"py-2 " + (excess >= 0 ? "text-emerald-700" : "text-red-700")}>
                          {fmtUSD(excess)}
                        </td>
                        <td className="py-2">Excess cash</td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <div className="mt-4 text-xs text-slate-500">
                  Tip: Click “Fund needs this month” to update funded balances … mark Paid to archive a need so it stops rolling.
                </div>
              </div>
            </div>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
